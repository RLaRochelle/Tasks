library ("phytools")
#questions 1-3
trees<- list()
births<- c()
Fractions<- c()
NetDR<- c()
SpeciationRate<- c()
AvgBranchLength<- c()
for (i in 1:100){
births[i]<-runif(1)
Fractions[i]<- runif(1)
trees[[i]]<- pbtree(b=births[i],d=births[i]*Fractions[i],n=100)
NetDR[[i]]<-births[i]-births[i]*Fractions[i]
SpeciationRate[[i]]<-births[i]
AvgBranchLength[[i]]<-mean(trees[[i]]$edge.length)
}
totaltips<-log(sapply(trees,Ntip))
plot(NetDR,totaltips)
plot(SpeciationRate,AvgBranchLength)
cor(SpeciationRate,AvgBranchLength)
rate<-unlist(SpeciationRate)
cor(rate,AvgBranchLength)
length<-unlist(AvgBranchLength)
cor(rate,length)
plot(NetDR,totaltips)
line<-lm(totaltips~NetDR)
abline(line)
totaltips<-log(sapply(trees,Ntip))
plot(NetDR,totaltips)
line<-lm(totaltips~NetDR)
abline(line)
plot(SpeciationRate,AvgBranchLength)
rate<-unlist(SpeciationRate)
length<-unlist(AvgBranchLength)
cor(rate,length)
plot(NetDR,totaltips)
line<-lm(totaltips~NetDR)
abline(line)
totaltips<-log(sapply(trees,Ntip))
plot(NetDR,totaltips)
plot(SpeciationRate,AvgBranchLength)
rate<-unlist(SpeciationRate)
length<-unlist(AvgBranchLength)
cor(rate,length)
pdf("NetDR and tips", height=4, width=4)
plot(NetDR,totaltips)
dev.off()
pdf("Speciation rate and length", height=4, width=4)
plot(SpeciationRate,AvgBranchLength)
dev.off()
library ("phytools")
trees<- list()
births<- c()
Fractions<- c()
net_div<- c()
rate<- c()
length<- c()
for (i in 1:100){
births[i]<-runif(1)
Fractions[i]<- runif(1)
trees[[i]]<- pbtree(b=births[i],d=births[i]*Fractions[i],n=100)
net_div[[i]]<-births[i]-births[i]*Fractions[i]
rate[[i]]<-births[i]
length[[i]]<-mean(trees[[i]]$edge.length)
}
tips<-log(sapply(trees,Ntip))
plot(net_div,tips)
plot(rate,length)
rates<-unlist(rate)
lengths<-unlist(length)
cor(rate,length)
cor(rates,lengths)
pdf("Net diversity and tips", height=4, width=4)
plot(net_div,tips)
dev.off()
pdf("Speciation rate and length", height=4, width=4)
plot(rate,length)
dev.off()
max(length)
max(lengths)
Tree<-which(lengths==max)
#A group of us worked together in the library to do most of this, and Logan Bower helped me with much of the coding.
library ("phytools")
#questions 1-3
trees<- list()
births<- c()
Fractions<- c()
net_div<- c()
rate<- c()
length<- c()
for (i in 1:100){
births[i]<-runif(1)
Fractions[i]<- runif(1)
trees[[i]]<- pbtree(b=births[i],d=births[i]*Fractions[i],n=100)
net_div[[i]]<-births[i]-births[i]*Fractions[i]
rate[[i]]<-births[i]
length[[i]]<-mean(trees[[i]]$edge.length)
}
tips<-log(sapply(trees,Ntip))
plot(net_div,tips)
plot(rate,length)
rates<-unlist(rate)
lengths<-unlist(length)
cor(rates,lengths)
pdf("Net diversity and tips", height=4, width=4)
plot(net_div,tips)
dev.off()
pdf("Speciation rate and length", height=4, width=4)
plot(rate,length)
dev.off()
which(lengths==max(lengths))
Tree<-which(lengths==max(lengths))
Tree
library ("phytools")
#questions 1-3
trees<- list()
births<- c()
Fractions<- c()
net_div<- c()
rate<- c()
length<- c()
for (i in 1:100){
births[i]<-runif(1)
Fractions[i]<- runif(1)
trees[[i]]<- pbtree(b=births[i],d=births[i]*Fractions[i],n=100)
net_div[[i]]<-births[i]-births[i]*Fractions[i]
rate[[i]]<-births[i]
length[[i]]<-mean(trees[[i]]$edge.length)
}
tips<-log(sapply(trees,Ntip))
plot(net_div,tips)
plot(rate,length)
rates<-unlist(rate)
lengths<-unlist(length)
cor(rates,lengths)
pdf("Net diversity and tips", height=4, width=4)
plot(net_div,tips)
dev.off()
pdf("Speciation rate and length", height=4, width=4)
plot(rate,length)
dev.off()
#question 4 - as the net diversification rate increases, the log of the tips also increases
#question 5 - as the speciation rate increases, the average branch length decreases
#question 6 - the correlation between speciation rate and branch length is -0.5190412
Tree<-which(lengths==max(lengths))
trees
max_tree<-trees[[89]]
max_tree
tree
#Task 10
#A group of us worked together to do most of the first for loop and its questions. Logan Bower and Kayla Coffman helped me with much of the coding for that loop, and also a few parts of the second.
library ("phytools")
#questions 1-3
trees<- list()
births<- c()
Fractions<- c()
net_div<- c()
rate<- c()
length<- c()
for (i in 1:100){
births[i]<-runif(1)
Fractions[i]<- runif(1)
trees[[i]]<- pbtree(b=births[i],d=births[i]*Fractions[i],n=100)
net_div[[i]]<-births[i]-births[i]*Fractions[i]
rate[[i]]<-births[i]
length[[i]]<-mean(trees[[i]]$edge.length)
}
tips<-log(sapply(trees,Ntip))
plot(net_div,tips)
plot(rate,length)
sp_rate<-unlist(rate)
lengths<-unlist(length)
cor(sp_rate,lengths)
pdf("Net diversity and tips", height=4, width=4)
plot(net_div,tips)
dev.off()
pdf("Speciation rate and length", height=4, width=4)
plot(rate,length)
dev.off()
plotTree(Tree)
plot(Tree,cex=0.25)
plotTree(Tree,offset=1)
plot(Tree,type=fan)
plot(Tree,type="fan")
plotTree(Tree,type="fan")
#Task 10
#A group of us worked together to do most of the first for loop and its questions. Logan Bower and Kayla Coffman helped me with much of the coding for that loop, and also a few parts of the second.
library ("phytools")
#questions 1-3
trees<-list()
births<-c()
Fractions<-c()
net_div<-c()
rate<-c()
length<-c()
for (i in 1:100){
births[i]<-runif(1)
Fractions[i]<-runif(1)
trees[[i]]<-pbtree(b=births[i],d=births[i]*Fractions[i],n=100)
net_div[[i]]<-births[i]-births[i]*Fractions[i]
rate[[i]]<-births[i]
length[[i]]<-mean(trees[[i]]$edge.length)
}
tips<-log(sapply(trees,Ntip))
plot(net_div,tips)
plot(rate,length)
sp_rate<-unlist(rate)
lengths<-unlist(length)
cor(sp_rate,lengths)
pdf("Net diversity and tips", height=4, width=4)
plot(net_div,tips)
dev.off()
pdf("Speciation rate and length", height=4, width=4)
plot(rate,length)
dev.off()
#question 4 - as the net diversification rate increases, the log of the tips also increases
#question 5 - as the speciation rate increases, the average branch length decreases
#question 6 - the correlation between speciation rate and branch length is -0.2498617
trees
max_tree<-trees[[90]]
max_tree
Tree<-trees[[90]]
Tree
plotTree(Tree)
plotTree(Tree,type="fan")
plotTree(Tree,cex=0.25)
pdf("Tree", height=4, width=4)
plot(Tree,cex=0.25)
dev.off()
rates<-c()
traits<-c()
for (i in 1:100) {
rates[i]<-runif(1)
traits[[i]]<-fastBM(Tree,sig2=rates[i])
}
mean_rate<-mean(rates)
mean_trait<-mean(traits)
mean_trait<-mean(traits[i])
cor(mean_trait,mean_rate)
var_rate<-var(rates)
var_trait<-var(traits)
cor(var_trait,var_rate)
mean_rate<-mean(rates)
traits2<-unlist(traits)
mean_trait<-mean(traits2)
cor(mean_trait,mean_rate)
var_rate<-var(rates)
var_trait<-var(traits2)
cor(var_trait,var_rate
View(traits)
View(traits)
traits2<-unlist(traits[i])
mean_trait<-mean(traits2)
cor(mean_trait,mean_rate)
plot(mean_trait,mean_rate)
var_rate<-var(rates)
var_trait<-var(traits2)
cor(var_trait,var_rate)
traitMat<-cbind(traits[[1]],traits[[4]])
cor(traitMat)
mean_rate<-mean(rates[[i]])
mean_trait<-mean(traits[[i]])
cor(mean_trait,mean_rate)
traits2<-unlist(mean_trait)
plot(traits,mean_rate)
mean_rate[[i]]<-mean(rates[[i]])
mean_trait[[i]]<-mean(traits[[i]])
cor(mean_trait[[i]],mean_rate[[i]])
traits2<-unlist(mean_trait[[i]])
plot(traits,mean_rate)
plot(traits[[i]],mean_rate[[i]])
traits2[[i]]<-unlist(mean_trait[[i]])
plot(traits2[[i]],mean_rate[[i]])
pdf("correlation between rate and trait mean", height=4, width=4)
plot(traits2[[i]],mean_rate[[i]])
dev.off()
var_rate[[i]]<-var(rates[[i]])
var_trait[[i]]<-var(traits2[[i]])
cor(var_trait[[i]],var_rate[[i]])
traitMat<-cbind(traits[[1]],traits[[4]])
cor(traitMat)
